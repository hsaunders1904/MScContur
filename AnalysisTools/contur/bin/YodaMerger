#!/usr/bin/env python

from optparse import OptionParser

import rivet, yoda, sys, os

parser = OptionParser(usage=__doc__)
parser.add_option('-t', '--tags', dest='TAGS', action='store',
                   help='give two elements of file name to be matched, separated by a space', default=('mP','mY'), nargs=2)

opts, dummy = parser.parse_args()

for root, dirs, files in os.walk('.'):
        filelist=''
        outfile=''
        for name in files:
            #filelist=''
		if '.yoda' not in name:
			continue
		if opts.TAGS[0] not in name or opts.TAGS[1] not in name:
			continue
		# protect against rerunning...
		if 'LHC' not in name:
			continue
		yodafile = os.path.join(root, name)
		filelist += " " + yodafile
	print filelist
        if not filelist:
		continue
        else:
		os.system("yodamerge -o " + root + "/" +root.strip("./")+".yoda " + filelist)

#print 'break'
